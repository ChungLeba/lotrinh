<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>PARTNER | INFO</title>

  <!-- Google Font: Source Sans Pro -->
  <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:300,400,400i,700&display=fallback">
  <!-- Font Awesome -->
  <link rel="stylesheet" href="../../admin/plugins/fontawesome-free/css/all.min.css">
  <!-- Theme style -->
  <link rel="stylesheet" href="../../admin/dist/css/adminlte.min.css">
</head>
<body class="sidebar-mini sidebar-collapse">
<!-- Site wrapper -->
<div class="wrapper">

<%- include('../1.topmenu.partner.ejs'); %>
<%- include('../2.leftmenu.partner.ejs'); %>
  <!-- Content Wrapper. Contains page content -->
<div class="content-wrapper">
  <!-- Content Header (Page header) -->
  <section class="content-header">
      <div class="container-fluid">
      <div class="row mb-2">
          <div class="col-sm-6">
          <h1>Quản lý các nhà cung cấp</h1>
          </div>
          <div class="col-sm-6">
          <ol class="breadcrumb float-sm-right">
              <li class="breadcrumb-item"><a href="#">Home</a></li>
              <li class="breadcrumb-item active">Tất cả nhà cung cấp</li>
          </ol>
          </div>
      </div>
      </div><!-- /.container-fluid -->
  </section>
  
  <!-- Main content -->
  <section class="content">
      <div class="container-fluid">
          <div class="row">
              
              <div class="col-md-4">
                <div class="card card-primary">
                    <div class="card-header">
                        <h3 class="card-title">Thêm nhà cung cấp</h3>

                        
                    </div>
                    <div class="card-body">
                        
                        <div class="row">
                            <input class="form-control form-control-lg" type="text" placeholder="Lộ trình Việt" id="input_ten">
                        </div>
                        <div>
                            <p style="margin-bottom:2px; font-style: italic;">(*) Sau khi tạo trang nhà cung cấp, bạn có thể <a href="/partner/routers/add"> thêm các tuyến đường vận tải</a> để tiếp cận với rất nhiều khách hàng</p>    
                        </div>
                    </br>
                        <div class="row" id="div_lienhe">
                            <label for="lien-he">Liên hệ</label>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                <span class="input-group-text"><i class="fas fa-headset"></i></span>
                                </div>
                                <input class="form-control" type="text" placeholder="Ai hoặc bộ phận liên hệ" id="input_bophan">
                            </div>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                <span class="input-group-text"><i class="fas fa-phone"></i></span>
                                </div>
                                <input class="form-control" type="text" placeholder="09..." id="input_dienthoai">
                            </div>
                            <div class="input-group mb-3">
                                <div class="input-group-prepend">
                                <span class="input-group-text"><i class="fas fa-map-pin"></i></span>
                                </div>
                                <input class="form-control" type="text" placeholder="Số 77, Lê Văn Thịnh, ..." id="input_diachi">
                            </div>
                        </div>
                        
                        
                    </div>
                    <div class="card-footer">
                        <button type="button" class="btn btn-block bg-gradient-success" id="bt_save">Thêm nhà cung cấp</button>
                    </div>
                </div>
              </div>
  
              <div class="col-md-8">
                <div class="card">
                    <div class="card-body col text-center">
                        <a href="/partner/routers/add" class="btn btn-app bg-danger">
                            <i class="fas fa-route"></i> Thêm tuyến đường
                        </a>
                        <a href="/partner" class="btn btn-app bg-warning">
                            <i class="nav-icon fas fa-chart-line"></i> Trang tổng quan  
                        </a>
                        <a href="#" class="btn btn-app bg-primary">
                            <i class="fas fa-user-circle"></i> Thông tin cá nhân
                        </a>
                    </div>
                </div>
                  <div class="card card-success">
                      <div class="card-header">
                          <h3 class="card-title">Danh sách nhà cung cấp</h3>
                          </div>
                          <div class="card-body table-responsive p-0" style="height: auto;">
                              <table class="table table-head-fixed text-wrap">
                                  <thead>
                                  <tr>
                                      <th>#</th>
                                      <th>Nhà cung cấp</th>
                                      <th>Tuyến đường quản lý</th>
                                      <th>Liên hệ</th>
                                      <th>Trang riêng</th>
                                      
                                  </tr>
                                  </thead>
                                  <tbody id="tbody">
                                      <% for( let index = 0; index < data.length; index++ ) { %>
                                        <tr>
                                            <td><%- index + 1 %></td>
                                            <td>
                                                <a href="/partner/partner-info/<%- data[index]._id %>">
                                                    <%- data[index].tenncc %>
                                                </a>
                                                
                                            </td>
                                            <td><%- data[index].cactuyenql.length %></td>
                                            <td>
                                                <% for( let t = 0; t < data[index].caclienhe.length; t++ ) { %>
                                                    <li>
                                                        <%- data[index].caclienhe[t].bophan %>, <%- data[index].caclienhe[t].dienthoai %>, <%- data[index].caclienhe[t].diachi %>
                                                    </li>
                                                <% } %>
                                            </td>
                                            <td>
                                                <a href="/p/<%- data[index]._id %>">
                                                    <button class="btn btn-block btn-outline-primary btn-sm">Xem</button>
                                                </a>
                                            </td>
                                        </tr>
                                       
                                      <% } %>

                                  <!-- Loader -->
                                  </tbody>
                              </table>
                              </div>
                              <!-- /.card-body -->
                              <div class="card-footer">
                                  <div class="col text-center">
                                      <button id="bt_more" type="button" class="btn btn-block btn-outline-success"> Xem thêm 10 nhà cung cấp khác</button>
                                  </div>                
                              </div>
                  </div>
              </div>
              
  
              
          </div>
          
      </div>
      
  </section>
  <!-- /.content -->
  </div>
  <!-- /.content-wrapper -->

  <%- include('../3.footer.partner.ejs'); %>

  <!-- Control Sidebar -->
  <aside class="control-sidebar control-sidebar-dark">
    <!-- Control sidebar content goes here -->
  </aside>
  <!-- /.control-sidebar -->
</div>
<!-- ./wrapper -->

<!-- jQuery -->
<script src="../../admin/plugins/jquery/jquery.min.js"></script>
<script>
    $(document).ready(function(){
        $("#bt_save").click(function(){
            if($("#input_ten").val()==''){
                alert("Vui lòng điền tên nhà cung cấp")
            } else if($("#input_bophan").val()==''){
                alert("Vui lòng bổ sung bộ phận liên hệ")
            } else if($("#input_dienthoai").val()==''){
                alert("Vui lòng bổ sung số điện thoại liên hệ")
            } else if($("#input_diachi").val()=='') {
                alert("Vui lòng bổ sung địa chỉ liên hệ")
            } else {
                lienhe= {}
                lienhe.tt = 1
                lienhe.bophan = $("#input_bophan").val()
                lienhe.dienthoai = $("#input_dienthoai").val()
                lienhe.diachi = $("#input_diachi").val()
                console.log(lienhe)
                $.ajax({
                url:'/partner/partner-info',
                type:'POST',
                dataType: 'json',
                data: 
                {
                    userID: '<%-userID%>',
                    tenncc: $("#input_ten").val(),
                    lienhe: JSON.stringify(lienhe)
                }
                })
                .then(data=>{
                alert(data.mes)
                location.reload()
                })
                .catch(err=>{
                console.log(err)
                })
            }   
        })

    })
</script>
<!-- Bootstrap 4 -->
<script src="../../admin/plugins/bootstrap/js/bootstrap.bundle.min.js"></script>
<!-- AdminLTE App -->
<script src="../../admin/dist/js/adminlte.min.js"></script>
<!-- AdminLTE for demo purposes -->
<script src="../../admin/dist/js/demo.js"></script>
</body>
</html>
